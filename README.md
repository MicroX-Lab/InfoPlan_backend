# InfoPlan - è‡´åŠ›äºè§£å†³ä¿¡æ¯è¿‡è½½é—®é¢˜çš„æ™ºèƒ½å­¦ä¹ è§„åˆ’ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºå°çº¢ä¹¦æ•°æ®çˆ¬å–å’ŒAIå¤§æ¨¡å‹çš„æ™ºèƒ½å­¦ä¹ è§„åˆ’ç”Ÿæˆç³»ç»Ÿï¼Œæ”¯æŒç”¨æˆ·æœç´¢ã€ç¬”è®°è·å–å’Œä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„è§„åˆ’ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºå¹¶åˆ¶å®šåˆç†çš„å­¦ä¹ è®¡åˆ’ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

åœ¨ä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œæˆ‘ä»¬æ¯å¤©éƒ½é¢ä¸´ç€å¤§é‡çš„ä¿¡æ¯ï¼Œå¦‚ä½•ä»è¿™äº›ä¿¡æ¯ä¸­ç­›é€‰å‡ºæœ‰ä»·å€¼çš„å†…å®¹å¹¶å½¢æˆç³»ç»Ÿçš„å­¦ä¹ è®¡åˆ’ï¼Œæ˜¯ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ã€‚InfoPlan é¡¹ç›®æ—¨åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼å¸®åŠ©ç”¨æˆ·ï¼š

1. **æ™ºèƒ½æ•°æ®çˆ¬å–**ï¼šä»å°çº¢ä¹¦ç­‰å¹³å°è·å–é«˜è´¨é‡çš„å­¦ä¹ èµ„æºå’Œç¬”è®°
2. **ä¸ªæ€§åŒ–å­¦ä¹ è§„åˆ’**ï¼šåŸºäºAIå¤§æ¨¡å‹ç”Ÿæˆç¬¦åˆç”¨æˆ·éœ€æ±‚çš„å­¦ä¹ è·¯å¾„
3. **èµ„æºæ™ºèƒ½åŒ¹é…**ï¼šè‡ªåŠ¨åŒ¹é…ç›¸å…³ç¬”è®°åˆ°å­¦ä¹ æ­¥éª¤ï¼Œæä¾›ç³»ç»ŸåŒ–çš„å­¦ä¹ ææ–™

æœ¬é¡¹ç›®åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒæœåŠ¡ï¼š

1. **çˆ¬è™«æœåŠ¡ï¼ˆSpider Serviceï¼‰**ï¼šæä¾›å°çº¢ä¹¦ç”¨æˆ·ã€ç¬”è®°ç­‰æ•°æ®çš„çˆ¬å–API
2. **æ¨¡å‹æœåŠ¡ï¼ˆModel Serviceï¼‰**ï¼šåŸºäºAIå¤§æ¨¡å‹ç”Ÿæˆä¸ªæ€§åŒ–å­¦ä¹ è§„åˆ’

## âœ¨ ä¸»è¦åŠŸèƒ½

### çˆ¬è™«æœåŠ¡åŠŸèƒ½

- ğŸ” **ç”¨æˆ·æœç´¢**ï¼šæ”¯æŒå…³é”®è¯æœç´¢ç”¨æˆ·ï¼Œæ”¯æŒåˆ†é¡µå’Œæ‰¹é‡è·å–
- ğŸ“ **ç¬”è®°è·å–**ï¼šè·å–ç”¨æˆ·ç¬”è®°ã€ç¬”è®°è¯¦æƒ…ã€è¯„è®ºç­‰
- ğŸ’¾ **æ•°æ®å­˜å‚¨**ï¼šæ”¯æŒä¿å­˜ç¬”è®°æ•°æ®åˆ°Excelã€ä¸‹è½½åª’ä½“æ–‡ä»¶
- ğŸŒ **APIæœåŠ¡**ï¼šæä¾›RESTful APIæ¥å£ï¼Œæ”¯æŒè·¨åŸŸè®¿é—®
- ğŸ” **ç”¨æˆ·è®¤è¯**ï¼šæ”¯æŒé‚®ç®±æ³¨å†Œã€ç™»å½•ã€éªŒè¯å’Œå¯†ç é‡ç½®

### æ¨¡å‹æœåŠ¡åŠŸèƒ½

- ğŸ¤– **æ™ºèƒ½è§„åˆ’**ï¼šåŸºäºç”¨æˆ·ç›®æ ‡å’Œç¬”è®°å†…å®¹ç”Ÿæˆå­¦ä¹ æ­¥éª¤
- ğŸ“š **å†…å®¹åŒ¹é…**ï¼šè‡ªåŠ¨åŒ¹é…ç›¸å…³ç¬”è®°åˆ°å­¦ä¹ æ­¥éª¤
- ğŸ¯ **ä¸ªæ€§åŒ–æ¨è**ï¼šæ ¹æ®ç”¨æˆ·IDåˆ—è¡¨è·å–ç›¸å…³ç¬”è®°å¹¶ç”Ÿæˆè§„åˆ’
- ğŸ“Š **å­¦ä¹ è¿›åº¦è¿½è¸ª**ï¼šè®°å½•ç”¨æˆ·å­¦ä¹ è¿›åº¦ï¼Œæä¾›ä¸ªæ€§åŒ–å­¦ä¹ å»ºè®®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.11+
- Node.js (ç”¨äºæ‰§è¡ŒJSåŠ å¯†è„šæœ¬)
- å°çº¢ä¹¦Cookieï¼ˆéœ€è¦ç™»å½•è·å–ï¼‰
- MariaDBæ•°æ®åº“ï¼ˆç”¨äºç”¨æˆ·è®¤è¯ï¼‰

### å®‰è£…ä¾èµ–

#### å®‰è£…Pythonä¾èµ–

```bash
pip install -r requirements.txt
```

#### å®‰è£…Node.jsä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

```
# å°çº¢ä¹¦Cookie
COOKIES=your_xiaohongshu_cookies_here

# é‚®ä»¶æœåŠ¡é…ç½®ï¼ˆç”¨äºç”¨æˆ·è®¤è¯ï¼‰
MAIL_PASSWORD=your_email_password_here

# JWTå¯†é’¥ï¼ˆç”¨äºç”¨æˆ·è®¤è¯ï¼‰
JWT_SECRET=your-jwt-secret-key-here
```

### æ•°æ®åº“é…ç½®

æœ¬é¡¹ç›®ä½¿ç”¨MariaDBæ•°æ®åº“å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œé…ç½®å¦‚ä¸‹ï¼š

- **ä¸»æœº**ï¼š8.155.168.11
- **ç«¯å£**ï¼š3306
- **ç”¨æˆ·å**ï¼šroot
- **å¯†ç **ï¼šMicroXLab
- **æ•°æ®åº“**ï¼šinfoplan

### å¯åŠ¨çˆ¬è™«æœåŠ¡

#### å¯åŠ¨APIæœåŠ¡ï¼ˆé»˜è®¤ç«¯å£5001ï¼‰

```bash
python api_server.py
```

æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® `http://localhost:5001/health` æ£€æŸ¥æœåŠ¡çŠ¶æ€ã€‚

### å¯åŠ¨æ¨¡å‹æœåŠ¡

#### è®¾ç½®ç¯å¢ƒå˜é‡

```bash
# Windows
set SPIDER_API_URL=http://localhost:5001
set MODEL_PATH=/path/to/your/model
set MODEL_SERVICE_PORT=5002

# Linux/Mac
SPIDER_API_URL=http://localhost:5001 MODEL_PATH=/path/to/your/model MODEL_SERVICE_PORT=5002 python model_service_server.py
```

#### å¯åŠ¨æ¨¡å‹æœåŠ¡

```bash
cd XHS_Learing_Agent
python model_service_server.py
```

## ğŸ“– APIæ–‡æ¡£

### è®¤è¯æœåŠ¡APIï¼ˆç«¯å£5001ï¼‰

#### 1. ç”¨æˆ·æ³¨å†Œ

```http
POST /api/auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "msg": "æ³¨å†ŒæˆåŠŸï¼ŒéªŒè¯ç å·²å‘é€è‡³æ‚¨çš„é‚®ç®±",
  "data": {
    "email": "user@example.com",
    "verification_expiry": "2023-12-01T12:00:00"
  }
}
```

#### 2. é‚®ç®±éªŒè¯

```http
POST /api/auth/verify-email
Content-Type: application/json

{
  "email": "user@example.com",
  "code": "123456"
}
```

#### 3. ç”¨æˆ·ç™»å½•

```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "msg": "ç™»å½•æˆåŠŸ",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer",
    "user": {
      "id": 1,
      "email": "user@example.com"
    }
  }
}
```

#### 4. è¯·æ±‚é‡ç½®å¯†ç 

```http
POST /api/auth/request-reset
Content-Type: application/json

{
  "email": "user@example.com"
}
```

#### 5. é‡ç½®å¯†ç 

```http
POST /api/auth/reset-password
Content-Type: application/json

{
  "email": "user@example.com",
  "token": "reset_token",
  "new_password": "new_password123"
}
```

### çˆ¬è™«æœåŠ¡APIï¼ˆç«¯å£5001ï¼‰

#### 1. æœç´¢ç”¨æˆ·

```http
POST /api/search/user
Content-Type: application/json

{
  "query": "ç¾é£Ÿ",
  "page": 1,
  "proxies": {}  // å¯é€‰
}
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "msg": "æˆåŠŸ",
  "data": {
    "users": [...],
    "has_more": true
  }
}
```

#### 2. æ‰¹é‡æœç´¢ç”¨æˆ·

```http
POST /api/search/user/batch
Content-Type: application/json

{
  "query": "ç¾é£Ÿ",
  "require_num": 15
}
```

#### 3. è·å–ç”¨æˆ·ç¬”è®°

```http
POST /api/users/notes
Content-Type: application/json

{
  "user_ids": ["user_id1", "user_id2"],
  "max_users": 5,
  "notes_per_user": 5
}
```

#### 4. è·å–å•ä¸ªç”¨æˆ·ç¬”è®°

```http
GET /api/user/notes/{user_id}?limit=20
```

#### 5. å¥åº·æ£€æŸ¥

```http
GET /health
```

### æ¨¡å‹æœåŠ¡APIï¼ˆç«¯å£5002ï¼‰

#### ç”Ÿæˆå­¦ä¹ è§„åˆ’

```http
POST /api/learning/plan
Content-Type: application/json
{
  "goal": "æˆ‘æƒ³å­¦ä¹ AI agentçš„ç®€å•å¼€å‘",
  "user_ids": ["user_id1", "user_id2"],
  "max_users": 5,
  "notes_per_user": 5,
  "debug": false
}
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "msg": "å­¦ä¹ è§„åˆ’ç”ŸæˆæˆåŠŸ",
  "data": {
    "goal": "æˆ‘æƒ³å­¦ä¹ AI agentçš„ç®€å•å¼€å‘",
    "steps": [
      {
        "step_number": 1,
        "description": "äº†è§£AI AgentåŸºç¡€æ¦‚å¿µ",
        "recommended_notes": [...]
      }
    ],
    "statistics": {
      "total_users": 5,
      "total_notes": 25,
      "total_steps": 5
    }
  }
}
```

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### Pythonä»£ç ç¤ºä¾‹

#### æœç´¢ç”¨æˆ·

```python
import requests

response = requests.post('http://localhost:5001/api/search/user', json={
    'query': 'ç¾é£Ÿ',
    'page': 1
})
users = response.json()
print(users)
```

#### è·å–ç”¨æˆ·ç¬”è®°

```python
import requests

response = requests.post('http://localhost:5001/api/users/notes', json={
    'user_ids': ['user_id1', 'user_id2'],
    'max_users': 5,
    'notes_per_user': 5
})
notes = response.json()
print(notes)
```

#### ç”Ÿæˆå­¦ä¹ è§„åˆ’

```python
import requests

response = requests.post('http://localhost:5002/api/learning/plan', json={
    'goal': 'æˆ‘æƒ³å­¦ä¹ Pythonçˆ¬è™«',
    'user_ids': ['user_id1', 'user_id2'],
    'max_users': 5,
    'notes_per_user': 5
})
plan = response.json()
print(plan)
```

#### ç”¨æˆ·æ³¨å†Œ

```python
import requests

response = requests.post('http://localhost:5001/api/auth/register', json={
    'email': 'user@example.com',
    'password': 'password123'
})
print(response.json())
```

#### ç”¨æˆ·ç™»å½•

```python
import requests

response = requests.post('http://localhost:5001/api/auth/login', json={
    'email': 'user@example.com',
    'password': 'password123'
})
print(response.json())
```

### çˆ¬è™«æœåŠ¡é…ç½®

åœ¨ `api_server.py` ä¸­é…ç½®ï¼š

- **ç«¯å£**ï¼šé»˜è®¤5001
- **Cookie**ï¼šé€šè¿‡ç¯å¢ƒå˜é‡ `COOKIES` è®¾ç½®
- **é‚®ä»¶æœåŠ¡**ï¼šé€šè¿‡ç¯å¢ƒå˜é‡ `MAIL_PASSWORD` è®¾ç½®
- **JWTå¯†é’¥**ï¼šé€šè¿‡ç¯å¢ƒå˜é‡ `JWT_SECRET` è®¾ç½®

### æ¨¡å‹æœåŠ¡é…ç½®

åœ¨ `XHS_Learing_Agent/config.py` ä¸­é…ç½®ï¼š

- `MODEL_PATH`: æ¨¡å‹æ–‡ä»¶è·¯å¾„
- `SPIDER_API_URL`: çˆ¬è™«æœåŠ¡åœ°å€
- `MODEL_SERVICE_PORT`: æ¨¡å‹æœåŠ¡ç«¯å£

## ğŸ”’ æ³¨æ„äº‹é¡¹

1. **Cookieå®‰å…¨**ï¼šè¯·å¦¥å–„ä¿ç®¡Cookieï¼Œä¸è¦æäº¤åˆ°ä»£ç ä»“åº“
2. **è¯·æ±‚é¢‘ç‡**ï¼šè¯·åˆç†æ§åˆ¶è¯·æ±‚é¢‘ç‡ï¼Œé¿å…è¢«å°ç¦
3. **æ•°æ®ä½¿ç”¨**ï¼šè¯·éµå®ˆå°çº¢ä¹¦çš„ä½¿ç”¨æ¡æ¬¾ï¼Œä»…ç”¨äºå­¦ä¹ ç ”ç©¶
4. **æ¨¡å‹è·¯å¾„**ï¼šç¡®ä¿æ¨¡å‹æ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼Œæ¨¡å‹æœåŠ¡æ‰èƒ½æ­£å¸¸å¯åŠ¨
5. **é‚®ä»¶é…ç½®**ï¼šç¡®ä¿é‚®ä»¶æœåŠ¡é…ç½®æ­£ç¡®ï¼Œå¦åˆ™ç”¨æˆ·è®¤è¯åŠŸèƒ½æ— æ³•ä½¿ç”¨
6. **æ•°æ®åº“é…ç½®**ï¼šç¡®ä¿æ•°æ®åº“é…ç½®æ­£ç¡®ï¼Œå¦åˆ™ç”¨æˆ·è®¤è¯åŠŸèƒ½æ— æ³•ä½¿ç”¨

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
InfoPlan_backend/
â”œâ”€â”€ apis/                  # APIæ¥å£å®ç°
â”‚   â”œâ”€â”€ auth_apis.py       # è®¤è¯ç›¸å…³API
â”‚   â””â”€â”€ xhs_pc_apis.py     # å°çº¢ä¹¦çˆ¬è™«API
â”œâ”€â”€ auth/                  # è®¤è¯ç›¸å…³åŠŸèƒ½
â”‚   â”œâ”€â”€ email.py           # é‚®ä»¶å‘é€åŠŸèƒ½
â”‚   â””â”€â”€ utils.py           # è®¤è¯å·¥å…·å‡½æ•°
â”œâ”€â”€ db_config.py           # æ•°æ®åº“é…ç½®
â”œâ”€â”€ db_connection.py       # æ•°æ®åº“è¿æ¥
â”œâ”€â”€ models/                # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ user.py            # ç”¨æˆ·æ¨¡å‹
â”œâ”€â”€ tests/                 # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ xhs_utils/             # å°çº¢ä¹¦å·¥å…·å‡½æ•°
â”œâ”€â”€ api_server.py          # APIæœåŠ¡å¯åŠ¨æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
```

### æ·»åŠ æ–°çš„APIæ¥å£

1. åœ¨ `apis/` ç›®å½•ä¸­æ·»åŠ æ–°çš„APIå®ç°æ–‡ä»¶æˆ–åœ¨ç°æœ‰æ–‡ä»¶ä¸­æ·»åŠ æ–°æ–¹æ³•
2. åœ¨ `api_server.py` ä¸­æ·»åŠ å¯¹åº”çš„è·¯ç”±
3. æ›´æ–°APIæ–‡æ¡£

### æ‰©å±•æ•°æ®æä¾›è€…

1. å®ç° `data_providers/interfaces.py` ä¸­çš„æ¥å£
2. åœ¨ `model_service` ä¸­ä½¿ç”¨æ–°çš„æ•°æ®æä¾›è€…

### æ•°æ®åº“è¿ç§»

å½“ä¿®æ”¹æ•°æ®æ¨¡å‹æ—¶ï¼Œéœ€è¦æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼š

```bash
# ç”Ÿæˆè¿ç§»è„šæœ¬
python -m alembic revision --autogenerate -m "description"

# æ‰§è¡Œè¿ç§»
python -m alembic upgrade head
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼æˆ‘ä»¬éå¸¸æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

- ä¿®å¤bug
- æ·»åŠ æ–°åŠŸèƒ½
- æ”¹è¿›æ–‡æ¡£
- ä¼˜åŒ–æ€§èƒ½

## ğŸ“® è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ä»¬ï¼š

- **GitHub Issue**ï¼šåœ¨é¡¹ç›®ä»“åº“ä¸­æäº¤Issue
- **é‚®ç®±**ï¼šnono@ycy.fan
- **å¾®ä¿¡**ï¼šè¯·åœ¨Issueä¸­ç•™ä¸‹æ‚¨çš„è”ç³»æ–¹å¼

## ğŸ“Š é¡¹ç›®çŠ¶æ€

- **å¼€å‘çŠ¶æ€**ï¼šæ´»è·ƒå¼€å‘ä¸­
- **æµ‹è¯•çŠ¶æ€**ï¼šåŸºæœ¬åŠŸèƒ½æµ‹è¯•é€šè¿‡
- **éƒ¨ç½²çŠ¶æ€**ï¼šå¯æœ¬åœ°éƒ¨ç½²

---

**âš ï¸ å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºæŠ€æœ¯å­¦ä¹ å’Œç ”ç©¶ï¼Œä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨é£é™©ï¼Œå¹¶éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œå¹³å°è§„åˆ™ã€‚

**ğŸ“ æ›´æ–°æ—¥å¿—**ï¼š

- 2024-01-19ï¼šå®Œå–„ç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼Œæ·»åŠ é‚®ä»¶å‘é€å’Œå¯†ç é‡ç½®åŠŸèƒ½
- 2024-01-18ï¼šæ·»åŠ æ¨¡å‹æœåŠ¡ï¼Œæ”¯æŒç”Ÿæˆä¸ªæ€§åŒ–å­¦ä¹ è§„åˆ’
- 2024-01-17ï¼šæ·»åŠ çˆ¬è™«æœåŠ¡ï¼Œæ”¯æŒå°çº¢ä¹¦ç”¨æˆ·å’Œç¬”è®°çˆ¬å–
- 2024-01-16ï¼šé¡¹ç›®åˆå§‹åŒ–ï¼Œæ­å»ºåŸºæœ¬æ¡†æ¶

---

**ğŸŒŸ æ„Ÿè°¢**ï¼š

- å°çº¢ä¹¦å¹³å°æä¾›çš„ä¸°å¯Œå­¦ä¹ èµ„æº
- æ‰€æœ‰ä¸ºé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…
- æ‰€æœ‰ä½¿ç”¨å’Œæ”¯æŒæœ¬é¡¹ç›®çš„ç”¨æˆ·

---

**InfoPlan** - è®©å­¦ä¹ æ›´æ™ºèƒ½ï¼Œè®©ä¿¡æ¯æ›´æœ‰ä»·å€¼ï¼
